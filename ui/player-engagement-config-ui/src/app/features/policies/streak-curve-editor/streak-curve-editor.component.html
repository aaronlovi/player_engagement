<div class="streak-editor">
  <div class="streak-editor__header">
    <div>
      <h3>Streak curve</h3>
      <p class="muted">Add rows for each day; day index is auto-validated to be sequential.</p>
    </div>
    <button type="button" (click)="addRow()">Add day</button>
  </div>

  @if (hasError()) {
    <div class="alert alert--error">
      {{ errorMessage() }}
    </div>
  }

  <div class="table-wrapper">
    <table>
      <thead>
        <tr>
          <th>Day</th>
          <th>Multiplier</th>
          <th>Bonus XP</th>
          <th>Cap next day</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        @for (row of rows; let i = $index; track i) {
          <tr>
            <td>
              <input type="number" [formControl]="row.controls.dayIndex" (input)="onFieldChange()" min="0" />
            </td>
            <td>
              <input type="number" step="0.01" [formControl]="row.controls.multiplier" (input)="onFieldChange()" min="0" />
            </td>
            <td>
              <input type="number" [formControl]="row.controls.additiveBonusXp" (input)="onFieldChange()" min="0" />
            </td>
            <td>
              <input type="checkbox" [formControl]="row.controls.capNextDay" (change)="onFieldChange()" />
            </td>
            <td>
              <button type="button" class="ghost" (click)="removeRow(i)">Remove</button>
            </td>
          </tr>
        }
      </tbody>
    </table>
  </div>
</div>
