# Scaffolding Technical Requirements

| Section                               | Requirement             | Description / Details                                                                                                                                       |
| ------------------------------------- | ----------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **1. Overview**                       | Purpose                 | Define the local scaffolding baseline for the XP Grant subsystem so later feature work can plug into it quickly.                                           |
|                                       | Scope                   | Backend host with Orleans + Minimal API stubs, database migrations and local Postgres orchestration, and an Angular workspace shell. Business logic, repositories, and production hardening are explicitly out-of-scope. |
|                                       | Dependencies            | .NET 8 SDK, Orleans 8.x, PostgreSQL (local instance), Npgsql, `InnoAndLogic.Persistence` (for Evolve migrations), Angular CLI.                              |
| **2. Architecture**                   | Service                 | Single Orleans silo that also hosts a Minimal API surface exposing placeholder endpoints (e.g., `/health`, `/xp/*` returning 501) to verify wiring.        |
|                                       | Persistence             | PostgreSQL schema managed via Evolve migrations embedded in `PlayerEngagement.Infrastructure`.                                                               |
|                                       | UI Layer                | Angular workspace providing a stub admin experience (basic layout + service calling the placeholder endpoints).                                             |
|                                       | Containerization        | Local docker compose file provisioning Postgres + pgAdmin with configurable credentials; no additional services required.                                   |
| **3. Development Environment**        | Language & Runtime      | C# 8 on .NET 8 for backend projects.                                                                                                                        |
|                                       | Project Structure       | `PlayerEngagement.sln` under `src/` containing `PlayerEngagement.Host`, `PlayerEngagement.Infrastructure`, and `PlayerEngagement.Domain` (currently a stub). |
|                                       | Database                | PostgreSQL v15+, schema name supplied via `${schema}` placeholder (`player_engagement` for local).                                                          |
|                                       | Migration Tool          | Evolve driven by `InnoAndLogic.Persistence`; migrations embed under `PlayerEngagement.Infrastructure/Persistence/Migrations`.                               |
|                                       | Testing Framework       | xUnit (placeholder onlyâ€”actual tests follow once business logic exists).                                                                                    |
|                                       | Front-End Framework     | Angular 17+ generated via Angular CLI; keep initial module/component minimal.                                                                               |
|                                       | Local Configuration     | Use `appsettings.json`/`appsettings.Development.json` to store Dbm options. Secrets remain in environment variables when running locally.                   |
| **4. Core Scaffolding Components**    | Backend Host Stub       | Orleans silo + Minimal API with health endpoint and stubbed `/xp` routes returning `501` or mocked payloads.                                               |
|                                       | Database Layer          | Initial schema migration (`V001__init_schema.sql`) loaded through DbmService; follow-up migrations deferred until requirements expand.                     |
|                                       | Angular Shell           | Angular workspace with routing, environment config, and service capable of calling the stubbed API endpoints.                                              |
|                                       | Local Tooling           | Docker compose for Postgres/pgAdmin; optional scripts or documentation to start/stop the stack.                                                            |
| **5. Deliverables (Scaffolding Phase)** | Backend                 | Running host project with Minimal API stubs, persistence wiring, and documented startup instructions.                                                      |
|                                       | UI                      | Angular workspace checked into `ui/player-engagement-config-ui/` with a placeholder page confirming connectivity.                                           |
|                                       | Documentation           | Updated scaffolding backlog and readme snippets guiding developers through running migrations, host, and UI.                                               |
| **6. Deferred (Post-Scaffolding)**    | Domain Logic            | Grant, streak, and rule grains/services, repository implementations, and projection logic.                                                                  |
|                                       | Testing                 | xUnit integration/unit suites covering domain behavior, repositories, and API flows.                                                                        |
|                                       | UI Features             | Full XP rule editor, dashboards, authentication, and production-ready styling.                                                                              |
